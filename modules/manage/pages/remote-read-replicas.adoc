= Remote Read Replicas
:description: Create read-only topics (Remote Read Replica topics) that mirror topics on a different cluster.
:contextLinks: [{"name"=>"Linux", "to"=>"manage/remote-read-replicas"}, {"name"=>"Kubernetes", "to"=>"manage/kubernetes/remote-read-replicas"}]
:deployment: Linux
:linkRoot: ../../

import ReduceLag from './shared/remote-read-replicas/_reduce-lag.mdx';
import AboutRemoteReadReplicas from './shared/remote-read-replicas/_intro.mdx';

import ContextLink from '@site/src/components/ContextButton.js'

<ContextLink frontmatter=\{frontMatter}
/>

<AboutRemoteReadReplicas frontmatter=\{frontMatter}/>

:::tip
To create a Remote Read Replica topic in another region, consider using a https://aws.amazon.com/s3/features/multi-region-access-points/[multi-region bucket] to simplify deployment and optimize performance.
:::

== Create a topic with object storage

Before you can create a Remote Read Replica topic, you must create a topic on the origin cluster and set up a bucket or container for the topic's object storage.

. Create a bucket or container to store the original data.
. Create the original topic by running `rpk topic create <topic_name>` and specifying the number of partitions and the number of replicas.
. Enable object storage on the origin cluster by running `rpk cluster config edit`, and then specifying cluster properties specific to your object storage provider:
+
|===
| Property | Description

| xref:reference:cluster-properties:.adoc#cloud_storage_enabled[`cloud_storage_enabled`]
| Must be set to `true` to enable object storage.

| xref:reference:tunable-properties:.adoc#cloud_storage_enable_remote_write[`cloud_storage_enable_remote_write`]
| When using Tiered Storage on the origin cluster, set to `true` to enable data to be uploaded from Redpanda and written to object storage for all topics. +
 +
To only enable data upload for a specific topic, set `cloud_storage_enable_remote_write: false` and run `rpk topic create <topic_name> -c redpanda.remote.write=true` when you create the topic.

| xref:reference:tunable-properties:.adoc#cloud_storage_enable_remote_read[`cloud_storage_enable_remote_read`]
| When using Tiered Storage on the origin cluster, set to `true` to enable consumers to read from all topics in object storage. +
 +
To enable consumers to only read from one topic, set `cloud_storage_enable_remote_read: false` and run `rpk topic create <topic_name> -c redpanda.remote.read=true` when you create the topic.

| xref:reference:cluster-properties:.adoc#cloud_storage_bucket[`cloud_storage_bucket`]
| AWS or GCS bucket name where the original data is stored. +
Required for AWS and GCS.

| xref:reference:cluster-properties:.adoc#cloud_storage_access_key[`cloud_storage_access_key`]
| AWS or GCS access key. +
Required for AWS and GCS authentication with access keys.

| xref:reference:cluster-properties:.adoc#cloud_storage_secret_key[`cloud_storage_secret_key`]
| AWS or GCS secret key. +
Required for AWS and GCS authentication with access keys.

| xref:reference:cluster-properties:.adoc#cloud_storage_region[`cloud_storage_region`]
| Object storage region. +
Required for AWS and GCS.

| xref:reference:cluster-properties:.adoc#cloud_storage_api_endpoint[`cloud_storage_api_endpoint`]
| AWS or GCS API endpoint. +
- For AWS, this can be left blank. It's generated automatically using the region and bucket. +
- For GCS, use `storage.googleapis.com`.

| xref:reference:cluster-properties:.adoc#cloud_storage_azure_container[`cloud_storage_azure_container`]
| Azure container name. +
Required for ABS.

| xref:reference:cluster-properties:.adoc#cloud_storage_azure_storage_account[`cloud_storage_azure_storage_account`]
| Azure account name. +
Required for ABS.

| xref:reference:cluster-properties:.adoc#cloud_storage_azure_shared_key[`cloud_storage_azure_shared_key`]
| Azure shared key. +
Required for ABS.
|===

== Create a Remote Read Replica topic

To set up a Remote Read Replica topic on a separate remote cluster:

. Create a remote cluster for the Remote Read Replica topic.
 ** If that's a multi-region bucket/container, you can create the read replica cluster in any region that has that bucket/container.
 ** If that's a single-region bucket/container, the remote cluster must be in the same region as the bucket/container.
. Run `rpk cluster config edit`, and then specify properties specific to your object storage provider:
+
|===
| Property | Description

| `cloud_storage_enabled`
| Must be set to `true` to enable object storage.

| `cloud_storage_bucket: "none"`
| No AWS or GCS bucket is needed for the remote cluster.

| `cloud_storage_access_key`
| AWS or GCS access key. +
Required for AWS and GCS authentication with access keys.

| `cloud_storage_secret_key`
| AWS or GCS secret key. +
Required for AWS and GCS authentication with access keys.

| `cloud_storage_region`
| Object storage region of the remote cluster. +
Required for AWS and GCS.

| `cloud_storage_api_endpoint`
| AWS or GCS API endpoint. +
- For AWS, this can be left blank. It's generated automatically using the region and bucket. +
- For GCS, use `storage.googleapis.com`.

| `cloud_storage_azure_container`
| Azure container name. +
Required for ABS.

| `cloud_storage_azure_storage_account`
| Azure account name. +
Required for ABS.

| `cloud_storage_azure_shared_key`
| Azure shared key. +
Required for ABS.
|===

. Create the Remote Read Replica topic by running `rpk topic create <topic_name> -c redpanda.remote.readreplica=<bucket_name>`.
 ** For `<topic_name>`, use the same name as the original topic.
 ** For `<bucket_name>`, use the bucket or container specified in the `cloud_storage_bucket` or `cloud_storage_azure_container` property for the origin cluster.

+
:::info
 ** The Remote Read Replica cluster must run on the same version of Redpanda as the origin cluster, or just one feature release ahead of the origin cluster. For example, if the origin cluster is version 23.1, the Remote Read Replica cluster can be 23.2, but not 23.4. It cannot skip feature releases.
 ** During upgrades, upgrade the Remote Read Replica cluster before upgrading the origin cluster.
 ** Do not use `redpanda.remote.read` or `redpanda.remote.write` with `redpanda.remote.readreplica`. Redpanda ignores the values for remote read and remote write properties on read replica topics.
 :::

== Reduce lag in data availability

<ReduceLag frontmatter=\{frontMatter}/>

== Suggested reading

* https://redpanda.com/blog/remote-read-replicas-for-distributing-work[Remote Read Replicas: Read-only topics in Tiered Storage]
